<!DOCTYPE html>
<html lang="en">

<head>

  <!-- wm -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Comic Book Recommendations, Bub.</title>
  <script type="text/javascript" src="brython.js"></script>
  <script type="text/javascript" src="brython_stdlib.js"></script>

  <!-- My Custom CSS -->

  <!-- Bootstrap core CSS -->
  <!-- <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"> -->
  <!-- <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="vendor/bootstrap/css/bootstrap.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
  <!-- <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/css?family=Nunito+display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Hind&display=swap" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
    rel="stylesheet">

  <!-- Custom styles for this template -->
  <!-- <link href="css/grayscale.min.css" rel="stylesheet"> -->
  <link href="css/grayscale.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">

</head>

<body id="page-top" onload="brython(1)">

  <script type="text/python3">
    from browser import document, ajax, html
    import json
    import warnings

    def show_recommendations(response):
        if response.status==200 or response.status==0:
            recs = json.loads(response.text)
            cards = '<div class="row">'
            for rec in recs:
              this_card = ( '<div class="col-md-4 mb-3 mb-md-0">' + 
                                            '<div class="card mx-auto" style="width: 18rem;">' +
                                              '<div class="card-body text-center">' +
                                                '<h4 class="text-uppercase m-0">' + str(rec['comic_title']) + '</h4>' + 
                                                '<img class="card-img-top" src="' + str(rec['img_url']) + '" alt="">' + 
                                                '<hr class="my-4"></div></div></div>'
                                        ) 
              cards = cards + this_card
            cards = cards + '</div>'
            document["recs"].html = cards
        else:
            warnings.warn(response.text)
        return recs

    def get_recommendations(ev):
        """Get recommendations."""
        req = ajax.ajax()
        req.bind('complete', show_recommendations)
        req.open('POST', '/recommend', True)
        req.set_header('content-type','application/json')
        data = json.dumps({'comic_input': document['comic_input'].value})
        req.send(data) 

    document["recom_button"].bind("click", get_recommendations) 
  
  </script>

  <!-- Header -->
  <header class="masthead">
    <div class="container d-flex h-100 align-items-center">
      <div class="mx-auto text-center">
        <h1 class="mx-auto my-0 text-uppercase">Comic Book Recommender</h1>
        <h2 class="text-white-50 mx-auto mt-2 mb-5">Tell us what you are reading,<br> we'll tell you what you should!
        </h2>
        <a href="#projects" class="btn btn-primary js-scroll-trigger">Assemble Your Recommendations</a>
      </div>
    </div>
  </header>

  <!-- Projects Section -->
  <section id="projects" class="projects-section bg-light">
    <div class="container align-items-center text-center">
      <!-- User Input - Comic 1 -->
      <h1>Select Your Favorite Comic!</h1>

      <div class="row align-items-center">
        <div class="card mx-auto" style="width: 20rem;">
          <div class="card-body align-items-center">
            <select id="comic_input" name=comics_select method="GET" action="/"
              onchange="document.getElementById('preview').src = this.value">
              {% for deet in com_deets %}
              <option value="{{deet[0]}}">{{deet[0]}}</option>
              {% endfor %}
            </select>
            <br><br>
            <img class="mx-auto d-block card-img-top" id="preview">
          </div>
        </div>
      </div>
      <br><br><br>
      <!--Recommendation Button-->
      <br><br>
      <div class="btn btn-primary center-block" button id="recom_button">Get Recommendations!</div>
      <br><br>
      <div id="recs"></div>
      <br><br>
      <hr>
      <br><br>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="contact-section bg-black">
    <div class="container">
      <div class="social d-flex justify-content-center" style="font-size: 48px;">
        <a href="https://github.com/MangrobanGit" class="mx-2">
          <i class="fab fa-linkedin-in"></i>
        </a>
        <a href="https://www.linkedin.com/in/werlindo/" class="mx-2">
          <i class="fab fa-github"></i>
        </a>
      </div>

    </div>

  </section>

  <!-- Footer -->
  <footer class="bg-black large text-center text-white-50">
    <div class="container">
      Copyright &copy; Werlindo Mangrobang 2019
      <br><br><br><br>
      <div class="small text-white-50">
        Cover Photo by Lena Rose on Unsplash
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="vendor/bootstrap/js/bootstrap.bundle.js"></script>

  <!-- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/grayscale.min.js"></script>

  <!-- This is the part where I break my page -->
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

</body>

</html>